{const e=this;(self.webpackChunkStylus=self.webpackChunkStylus||[]).push([["js_color_color-picker_js"],{9391:(e,t,o)=>{let r;o.d(t,{NAMED_COLORS:()=>l,RX_COLOR:()=>s,constrain:()=>constrain,constrainHue:()=>constrainHue,format:()=>format,formatAlpha:()=>formatAlpha,fromHSV:()=>fromHSV,guessType:()=>guessType,parse:()=>parse,snapToInt:()=>snapToInt,testAt:()=>testAt,toHSV:()=>toHSV});const n=3,a=/\s*[+-]?(\.\d+|\d+(\.\d*)?)(e[+-]?\d+)?/.source.replace(/\(/g,"(?:"),expandRe=e=>RegExp(e.source.replace(/N/g,a).replace(/A/g,"(?:deg|g?rad|turn)?"),"iy"),s={hex:/#([a-f\d]{3}(?:[a-f\d](?:[a-f\d]{2}){0,2})?)\b/iy,hsl:expandRe(/^NA(\s*(,N%\s*){2}(,N%?\s*)?|(\s+N%){2}\s*(\/N%?\s*)?)$/),hwb:expandRe(/^(NA|none)(\s+(N%|none)){2}\s*(\/(N%?|none)\s*)?$/),rgb:expandRe(/^N(%?)(\s*,N\1\s*,N\1\s*(,N%?\s*)?|\s+N\1\s+N\1\s*(\/N%?\s*)?)$/)},i={grad:.9,rad:180/Math.PI,turn:360},p={hex:RGBtoHSV,hsl:function({h:e,s:t,l:o,a:r}){const n=t*(o<50?o:100-o)/100;return{h:constrainHue(e),s:n+o?200*n/(n+o)/100:0,v:(n+o)/100,a:r}},hwb:function({h:e,w:t,b:o,a:r}){return t=constrain(0,100,t)/100,o=constrain(0,100,o)/100,{h:constrainHue(e),s:1===o?0:1-t/(1-o),v:1-o,a:r}},rgb:RGBtoHSV},c={hex:HSVtoRGB,hsl:function({h:e,s:t,v:o,a:r}){const n=(2-t)*o/2,a=n<.5?2*n:2-2*n;return{h:constrainHue(e),s:a?t*o/a*100:0,l:100*n,a:r}},hwb:function({h:e,s:t,v:o,a:r}){return{h:constrainHue(e),w:(1-t)*o*100,b:100*(1-o),a:r}},rgb:HSVtoRGB},guessType=e=>"r"in e?"rgb":"w"in e?"hwb":"v"in e?"hsv":"l"in e?"hsl":void 0,fromHSV=(e,t)=>c[t](e),toHSV=e=>p[e.type||"rgb"](e);function format(e="",t=e.type,{hexUppercase:o,usoMode:r,round:n}={}){if(!e||!t)return"string"==typeof e?e:"";const{a,type:s=guessType(e)}=e,i=formatAlpha(a),l=i?", "+i:"",u="hex"===s?"rgb":s,h="hex"===t?"rgb":t;e=u===h?e:c[h](p[u](e)),n=n?Math.round:e=>e;const{r:g,g:b,b:y,h:d,s:f,l:m,w:x}=e;switch(t){case"hex":{let e="#"+hex2(g)+hex2(b)+hex2(y)+(l?hex2(Math.round(255*a)):"");return r||(e=e.replace(/^#(.)\1(.)\2(.)\3(?:(.)\4)?$/,"#$1$2$3$4")),o?e.toUpperCase():e}case"rgb":{const e=[g,b,y].map(Math.round).join(", ");return r?e:`rgb${l?"a":""}(${e}${l})`}case"hsl":return`hsl${l?"a":""}(${n(d)}, ${n(f)}%, ${n(m)}%${l})`;case"hwb":return`hwb(${n(d)} ${n(x)}% ${n(y)}%${i?" / "+i:""})`}}function parse(e){return"string"==typeof e&&(e=e.trim())?"#"===e[0]?parseHex(e):e.endsWith(")")&&(e=e.match(/^(hwb|(hsl|rgb)a?)\(\s*([^)]+)/i))?parseFunc((e[2]||e[1]).toLowerCase(),e[3]):l.get(e.toLowerCase()):void 0}function initHexMap(){r=Array(256).fill(-65535);for(let e=48;e<58;e++)r[e]=e-48;for(let e=65;e<71;e++)r[e]=e-65+10;for(let e=97;e<103;e++)r[e]=e-97+10}function parseHex(e){let t,o,n,a;r||initHexMap();const s=e.length;if(4===s||5===s?(t=17*r[e.charCodeAt(1)])>=0&&(o=17*r[e.charCodeAt(2)])>=0&&(n=17*r[e.charCodeAt(3)])>=0&&(s<5||(a=17*r[e.charCodeAt(4)]/255)>=0):(7===s||9===s)&&(t=16*r[e.charCodeAt(1)]+r[e.charCodeAt(2)])>=0&&(o=16*r[e.charCodeAt(3)]+r[e.charCodeAt(4)])>=0&&(n=16*r[e.charCodeAt(5)]+r[e.charCodeAt(6)])>=0&&(s<9||(a=(16*r[e.charCodeAt(7)]+r[e.charCodeAt(8)])/255)>=0))return{type:"hex",r:t,g:o,b:n,a}}function parseFunc(e,t){if(!testAt(s[e],0,t))return;const o=t.trim().split(/\s*[,/]\s*|\s+/),r=parseFloat(o[0]),n=parseFloat(o[1]),a=parseFloat(o[2]),p=parseFloat(o[3]),c=isNaN(p)?void 0:constrain(0,1,o[3].endsWith("%")?p/100:p);if("rgb"===e){const t=o[0].endsWith("%")?2.55:1;return{type:e,r:constrain(0,255,Math.round(r*t)),g:constrain(0,255,Math.round(n*t)),b:constrain(0,255,Math.round(a*t)),a:c}}const l=constrainHue(r*(i[o[0].match(/\D*$/)[0].toLowerCase()]||1)),u=constrain(0,100,n||0),h=constrain(0,100,a||0);return"hwb"===e?{type:e,h:l,w:u,b:h,a:c}:{type:e,h:l,s:u,l:h,a:c}}function formatAlpha(e){return isNaN(e)?"":(e+.5*Math.pow(10,-n)).toFixed(n+1).slice(0,-1).replace(/^0(?=\.[1-9])|^1\.0+?$|\.?0+$/g,"")}function RGBtoHSV({r:e,g:t,b:o,a:r}){e/=255,t/=255,o/=255;const n=Math.max(e,t,o),a=n-Math.min(e,t,o);let s=0===a?0:n===e?(t-o)/a%6*60:n===t?60*((o-e)/a+2):n===o?60*((e-t)/a+4):0;return s=constrainHue(s),{h:s,s:0===n?0:a/n,v:n,a:r}}function HSVtoRGB({h:e,s:t,v:o,a:r}){e=constrainHue(e);const n=t*o,a=n*(1-Math.abs(e/60%2-1)),s=o-n,[i,p,c]=e>=0&&e<60?[n,a,0]:e>=60&&e<120?[a,n,0]:e>=120&&e<180?[0,n,a]:e>=180&&e<240?[0,a,n]:e>=240&&e<300?[a,0,n]:e>=300&&e<360?[n,0,a]:[];return{r:snapToInt(Math.round(255*(i+s))),g:snapToInt(Math.round(255*(p+s))),b:snapToInt(Math.round(255*(c+s))),a:r}}function constrain(e,t,o){return o<e?e:o>t?t:o}function constrainHue(e){return e<0?e%360+360:e>=360?e%360:e}function snapToInt(e){const t=Math.round(e);return Math.abs(t-e)<.001?t:e}function hex2(e){return(e<16?"0":"")+Math.round(e).toString(16)}function testAt(e,t,o){return!!e&&(e.lastIndex=t,e.test(o))}const l=new Map([["transparent",{r:0,g:0,b:0,a:0,type:"rgb"}],["aliceblue",{r:240,g:248,b:255,type:"hex"}],["antiquewhite",{r:250,g:235,b:215,type:"hex"}],["aqua",{r:0,g:255,b:255,type:"hex"}],["aquamarine",{r:127,g:255,b:212,type:"hex"}],["azure",{r:240,g:255,b:255,type:"hex"}],["beige",{r:245,g:245,b:220,type:"hex"}],["bisque",{r:255,g:228,b:196,type:"hex"}],["black",{r:0,g:0,b:0,type:"hex"}],["blanchedalmond",{r:255,g:235,b:205,type:"hex"}],["blue",{r:0,g:0,b:255,type:"hex"}],["blueviolet",{r:138,g:43,b:226,type:"hex"}],["brown",{r:165,g:42,b:42,type:"hex"}],["burlywood",{r:222,g:184,b:135,type:"hex"}],["cadetblue",{r:95,g:158,b:160,type:"hex"}],["chartreuse",{r:127,g:255,b:0,type:"hex"}],["chocolate",{r:210,g:105,b:30,type:"hex"}],["coral",{r:255,g:127,b:80,type:"hex"}],["cornflowerblue",{r:100,g:149,b:237,type:"hex"}],["cornsilk",{r:255,g:248,b:220,type:"hex"}],["crimson",{r:220,g:20,b:60,type:"hex"}],["cyan",{r:0,g:255,b:255,type:"hex"}],["darkblue",{r:0,g:0,b:139,type:"hex"}],["darkcyan",{r:0,g:139,b:139,type:"hex"}],["darkgoldenrod",{r:184,g:134,b:11,type:"hex"}],["darkgray",{r:169,g:169,b:169,type:"hex"}],["darkgrey",{r:169,g:169,b:169,type:"hex"}],["darkgreen",{r:0,g:100,b:0,type:"hex"}],["darkkhaki",{r:189,g:183,b:107,type:"hex"}],["darkmagenta",{r:139,g:0,b:139,type:"hex"}],["darkolivegreen",{r:85,g:107,b:47,type:"hex"}],["darkorange",{r:255,g:140,b:0,type:"hex"}],["darkorchid",{r:153,g:50,b:204,type:"hex"}],["darkred",{r:139,g:0,b:0,type:"hex"}],["darksalmon",{r:233,g:150,b:122,type:"hex"}],["darkseagreen",{r:143,g:188,b:143,type:"hex"}],["darkslateblue",{r:72,g:61,b:139,type:"hex"}],["darkslategray",{r:47,g:79,b:79,type:"hex"}],["darkslategrey",{r:47,g:79,b:79,type:"hex"}],["darkturquoise",{r:0,g:206,b:209,type:"hex"}],["darkviolet",{r:148,g:0,b:211,type:"hex"}],["deeppink",{r:255,g:20,b:147,type:"hex"}],["deepskyblue",{r:0,g:191,b:255,type:"hex"}],["dimgray",{r:105,g:105,b:105,type:"hex"}],["dimgrey",{r:105,g:105,b:105,type:"hex"}],["dodgerblue",{r:30,g:144,b:255,type:"hex"}],["firebrick",{r:178,g:34,b:34,type:"hex"}],["floralwhite",{r:255,g:250,b:240,type:"hex"}],["forestgreen",{r:34,g:139,b:34,type:"hex"}],["fuchsia",{r:255,g:0,b:255,type:"hex"}],["gainsboro",{r:220,g:220,b:220,type:"hex"}],["ghostwhite",{r:248,g:248,b:255,type:"hex"}],["gold",{r:255,g:215,b:0,type:"hex"}],["goldenrod",{r:218,g:165,b:32,type:"hex"}],["gray",{r:128,g:128,b:128,type:"hex"}],["grey",{r:128,g:128,b:128,type:"hex"}],["green",{r:0,g:128,b:0,type:"hex"}],["greenyellow",{r:173,g:255,b:47,type:"hex"}],["honeydew",{r:240,g:255,b:240,type:"hex"}],["hotpink",{r:255,g:105,b:180,type:"hex"}],["indianred",{r:205,g:92,b:92,type:"hex"}],["indigo",{r:75,g:0,b:130,type:"hex"}],["ivory",{r:255,g:255,b:240,type:"hex"}],["khaki",{r:240,g:230,b:140,type:"hex"}],["lavender",{r:230,g:230,b:250,type:"hex"}],["lavenderblush",{r:255,g:240,b:245,type:"hex"}],["lawngreen",{r:124,g:252,b:0,type:"hex"}],["lemonchiffon",{r:255,g:250,b:205,type:"hex"}],["lightblue",{r:173,g:216,b:230,type:"hex"}],["lightcoral",{r:240,g:128,b:128,type:"hex"}],["lightcyan",{r:224,g:255,b:255,type:"hex"}],["lightgoldenrodyellow",{r:250,g:250,b:210,type:"hex"}],["lightgray",{r:211,g:211,b:211,type:"hex"}],["lightgrey",{r:211,g:211,b:211,type:"hex"}],["lightgreen",{r:144,g:238,b:144,type:"hex"}],["lightpink",{r:255,g:182,b:193,type:"hex"}],["lightsalmon",{r:255,g:160,b:122,type:"hex"}],["lightseagreen",{r:32,g:178,b:170,type:"hex"}],["lightskyblue",{r:135,g:206,b:250,type:"hex"}],["lightslategray",{r:119,g:136,b:153,type:"hex"}],["lightslategrey",{r:119,g:136,b:153,type:"hex"}],["lightsteelblue",{r:176,g:196,b:222,type:"hex"}],["lightyellow",{r:255,g:255,b:224,type:"hex"}],["lime",{r:0,g:255,b:0,type:"hex"}],["limegreen",{r:50,g:205,b:50,type:"hex"}],["linen",{r:250,g:240,b:230,type:"hex"}],["magenta",{r:255,g:0,b:255,type:"hex"}],["maroon",{r:128,g:0,b:0,type:"hex"}],["mediumaquamarine",{r:102,g:205,b:170,type:"hex"}],["mediumblue",{r:0,g:0,b:205,type:"hex"}],["mediumorchid",{r:186,g:85,b:211,type:"hex"}],["mediumpurple",{r:147,g:112,b:219,type:"hex"}],["mediumseagreen",{r:60,g:179,b:113,type:"hex"}],["mediumslateblue",{r:123,g:104,b:238,type:"hex"}],["mediumspringgreen",{r:0,g:250,b:154,type:"hex"}],["mediumturquoise",{r:72,g:209,b:204,type:"hex"}],["mediumvioletred",{r:199,g:21,b:133,type:"hex"}],["midnightblue",{r:25,g:25,b:112,type:"hex"}],["mintcream",{r:245,g:255,b:250,type:"hex"}],["mistyrose",{r:255,g:228,b:225,type:"hex"}],["moccasin",{r:255,g:228,b:181,type:"hex"}],["navajowhite",{r:255,g:222,b:173,type:"hex"}],["navy",{r:0,g:0,b:128,type:"hex"}],["oldlace",{r:253,g:245,b:230,type:"hex"}],["olive",{r:128,g:128,b:0,type:"hex"}],["olivedrab",{r:107,g:142,b:35,type:"hex"}],["orange",{r:255,g:165,b:0,type:"hex"}],["orangered",{r:255,g:69,b:0,type:"hex"}],["orchid",{r:218,g:112,b:214,type:"hex"}],["palegoldenrod",{r:238,g:232,b:170,type:"hex"}],["palegreen",{r:152,g:251,b:152,type:"hex"}],["paleturquoise",{r:175,g:238,b:238,type:"hex"}],["palevioletred",{r:219,g:112,b:147,type:"hex"}],["papayawhip",{r:255,g:239,b:213,type:"hex"}],["peachpuff",{r:255,g:218,b:185,type:"hex"}],["peru",{r:205,g:133,b:63,type:"hex"}],["pink",{r:255,g:192,b:203,type:"hex"}],["plum",{r:221,g:160,b:221,type:"hex"}],["powderblue",{r:176,g:224,b:230,type:"hex"}],["purple",{r:128,g:0,b:128,type:"hex"}],["rebeccapurple",{r:102,g:51,b:153,type:"hex"}],["red",{r:255,g:0,b:0,type:"hex"}],["rosybrown",{r:188,g:143,b:143,type:"hex"}],["royalblue",{r:65,g:105,b:225,type:"hex"}],["saddlebrown",{r:139,g:69,b:19,type:"hex"}],["salmon",{r:250,g:128,b:114,type:"hex"}],["sandybrown",{r:244,g:164,b:96,type:"hex"}],["seagreen",{r:46,g:139,b:87,type:"hex"}],["seashell",{r:255,g:245,b:238,type:"hex"}],["sienna",{r:160,g:82,b:45,type:"hex"}],["silver",{r:192,g:192,b:192,type:"hex"}],["skyblue",{r:135,g:206,b:235,type:"hex"}],["slateblue",{r:106,g:90,b:205,type:"hex"}],["slategray",{r:112,g:128,b:144,type:"hex"}],["slategrey",{r:112,g:128,b:144,type:"hex"}],["snow",{r:255,g:250,b:250,type:"hex"}],["springgreen",{r:0,g:255,b:127,type:"hex"}],["steelblue",{r:70,g:130,b:180,type:"hex"}],["tan",{r:210,g:180,b:140,type:"hex"}],["teal",{r:0,g:128,b:128,type:"hex"}],["thistle",{r:216,g:191,b:216,type:"hex"}],["tomato",{r:255,g:99,b:71,type:"hex"}],["turquoise",{r:64,g:224,b:208,type:"hex"}],["violet",{r:238,g:130,b:238,type:"hex"}],["wheat",{r:245,g:222,b:179,type:"hex"}],["white",{r:255,g:255,b:255,type:"hex"}],["whitesmoke",{r:245,g:245,b:245,type:"hex"}],["yellow",{r:255,g:255,b:0,type:"hex"}],["yellowgreen",{r:154,g:205,b:50,type:"hex"}]])},2255:(e,t,o)=>{o.d(t,{default:()=>colorMimicry});var r=o(6001),n=o(9521);const a=new Map;function colorMimicry(e,t,o=document.body){(t=t||{}).fore="color";const a={},s={};let i=0,p=0;const c=getStyle(document.documentElement);for(const e in t){const o={r:0,g:0,b:0,a:0};blend(o,c[t[e]]),a[e]=o,p++}const l="string"==typeof e;l&&(e=o.appendChild((0,r.$create)(e,{style:"display: none"})));for(let o=e;o;o=o&&o.parentElement){const e=getStyle(o);for(const r in t)if(!s[r]&&(s[r]=blend(a[r],e[t[r]]),i+=s[r]?1:0,i===p)){o=null;break}a.style=a.style||e}l&&e.remove();for(const e in t){const t=a[e];isOpaque(t)||blend(a[e]={r:255,g:255,b:255,a:1},t);const{r:o,g:r,b:n,a:s}=a[e];a[e]=`rgba(${o}, ${r}, ${n}, ${s})`,a[e+"Luma"]=(.299*o+.587*r+.114*n)/256}return(0,n.debounce)(clearCache),a}function blend(e,t){let o,r,n,a;if("string"==typeof t?[o,r,n,a=255]=(t.match(/\d+/g)||[]).map(Number):({r:o,g:r,b:n,a=255}=t),255===a)e.r=o,e.g=r,e.b=n,e.a=1;else if(a){const t=1-(1-a/255)*(1-e.a),s=a/255/t,i=e.a*(1-t)/t;e.r=Math.round(o*s+e.r*i),e.g=Math.round(r*s+e.g*i),e.b=Math.round(n*s+e.b*i),e.a=t}return isOpaque(e)}function getStyle(e){let t=a.get(e);return t||(t=getComputedStyle(e),a.set(e,t)),t}function clearCache(){a.clear()}function isOpaque({a:e}){return Math.abs(e-1)<.001}},9209:(t,o,r)=>{r.r(o),r.d(o,{default:()=>ColorPicker});var n=r(9391),a=r(2255);function ColorPicker(t){const{constrain:o}=n,r="colorpicker-",s=[{hex:"#ff0000",start:0},{hex:"#ffff00",start:.17},{hex:"#00ff00",start:.33},{hex:"#00ffff",start:.5},{hex:"#0000ff",start:.67},{hex:"#ff00ff",start:.83},{hex:"#ff0000",start:1}];let i,p="0px",c={};const l={};let u,h,g,b,y,d,f,m,x,v,w,k,M=!1,C=!1,S={};const F={},H={},E={},P=!("ontouchstart"in document)||e.innerHeight>800,A={saturationPointerPos:{x:0,y:0},hueKnobPos:0,saturation:!1,hue:!1,opacity:!1,popup:!1};let N,T,O;const D={$root:u,show:function(t){M||init(),c={},i="",S=D.options=t,!1!==t.round&&(t.round=!0),N=document.activeElement,O=!1,T=t.color||"",v.title=t.tooltipForSwitcher||"",p=`${t.maxHeight||300}px`,u.className=[...u.classList].filter(e=>!e.startsWith(`${r}theme-`)).concat(r+"theme-"+("dark"===t.theme||"light"===t.theme?t.theme:guessTheme())).join(" "),document.body.appendChild(u),C=!0,e.addEventListener("keydown",onKeyDown,!0),e.addEventListener("mousedown",onMouseDown,!0),e.addEventListener("close-colorpicker-popup",onCloseRequest,!0),setFromColor(t.color),setFromHexLettercaseElement(),Array.isArray(S.palette)&&renderPalette(),(t.left||t.top||t.right||t.bottom)&&reposition()},hide,setColor,getColor:function(e){if(!M)return;readCurrentColorFromRamps();const t=n.fromHSV(c,e);return e?colorToString(t,e):t},options:S};return D;function init(){function $(e,t={},o=[]){(Array.isArray(t)||"string"==typeof t||t instanceof Node)&&(o=t,t={});const n=document.createElement(t.tag||"div");return n.className=toArray(e).map(e=>e?r+e:"").join(" "),n.append(...toArray(o).filter(Boolean)),t&&delete t.tag,Object.assign(n,t)}const t=/^\s*(0+\.?|0*\.\d+|0*1\.?|0*1\.0*)?\s*$/.source,makeNum=(e,t,o,r,n)=>{return $(["input-field",`${e}-${t}`],[(a=H,s=e,a[s]||(a[s]={}))[t]=$("input",o||{tag:"input",type:"number",min:r,max:n,step:1}),$("title",t.toUpperCase())]);var a,s},ColorGroup=(e,o)=>F[e]=$(["input-group",e],[...Object.entries(o).map(([t,o])=>makeNum(e,t,null,o[0],o[1])),makeNum(e,"a",{tag:"input",type:"text",pattern:t,spellcheck:!1})]);u=$("popup",{oninput:setFromInputs,onkeydown:setFromKeyboard},[h=$("saturation-container",{onmousedown:onSaturationMouseDown,onmouseup:onSaturationMouseUp},[$("saturation",[$("value",[g=$("drag-pointer")])])]),$("popup-mover",{onmousedown:onPopupMoveStart}),$("sliders",[$("hue",{onmousedown:onHueMouseDown},[b=$("hue-container",[y=$("hue-knob",{onmousedown:onHueKnobMouseDown})])]),$("opacity",[d=$("opacity-container",{onmousedown:onOpacityMouseDown},[f=$("opacity-bar"),m=$("opacity-knob",{onmousedown:onOpacityKnobMouseDown})])]),$("empty"),x=$("swatch")]),$(["input-container","hex"],[F.hex=$(["input-group","hex"],[$(["input-field","hex"],[w=$("input",{tag:"input",type:"text",spellcheck:!1,pattern:/^\s*#([a-fA-F\d]{3}([a-fA-F\d]([a-fA-F\d]{2}([a-fA-F\d]{2})?)?)?)\s*$/.source}),$("title",[E.true=$("title-action",{onclick:onHexLettercaseClicked},"HEX")," / ",E.false=$("title-action",{onclick:onHexLettercaseClicked},"hex")])])]),ColorGroup("rgb",{r:[0,255],g:[0,255],b:[0,255]}),ColorGroup("hsl",{h:[],s:[0,100],l:[0,100]}),ColorGroup("hwb",{h:[],w:[0,100],b:[0,100]}),$("format-change",[v=$("format-change-button",{onclick:setFromFormatElement},"↔")]),e.EyeDropper&&$("dropper",{tag:"img",srcset:"icon/eyedropper/16px.png, icon/eyedropper/32px.png 2x",async onclick(){try{const t=await(new e.EyeDropper).open();O=!0,setFromColor(t.sRGBHex),colorpickerCallback()}catch{}}})]),k=$("palette",{onclick:onPaletteClicked,oncontextmenu:onPaletteClicked})]);const inputsToObj=e=>{const t={type:e};for(const[o,r]of Object.entries(H[e]))t[o]=parseFloat(r.value);return t};for(const[e,t]of Object.entries(H))Object.defineProperty(t,"color",{get:inputsToObj.bind(null,e)});Object.defineProperty(H.hex=[w],"color",{get:()=>w.value.trim()}),Object.defineProperty(H,"color",{get:()=>H[i].color}),Object.defineProperty(H,"colorString",{get:()=>i&&n.format(H[i].color,void 0,{round:!0})}),s.forEach(e=>Object.assign(e,n.parse(e.hex))),u.style.setProperty("--margin","8px"),M=!0}function hide(){C&&(colorpickerCallback(""),e.removeEventListener("keydown",onKeyDown,!0),e.removeEventListener("mousedown",onMouseDown,!0),e.removeEventListener("close-colorpicker-popup",onCloseRequest,!0),releaseMouse(),focusNoScroll(N),u.remove(),C=!1)}function setColor(e){return"string"==typeof e?e=n.parse(e):"object"==typeof e&&e&&!e.type&&(e=Object.assign({},e,{type:n.guessType(e)})),!(!e||!e.type||(M||init(),setFromColor(e),0))}function readCurrentColorFromRamps(){if(0===h.offsetWidth)c.h=c.s=c.v=0;else{const{x:e,y:t}=A.saturationPointerPos;c.h=n.snapToInt(A.hueKnobPos/b.offsetWidth*360),c.s=e/h.offsetWidth,c.v=(h.offsetHeight-t)/h.offsetHeight}}function setFromSaturationElement(e){e.preventDefault();const t=h.offsetWidth,r=h.offsetHeight,n=u.getBoundingClientRect(),a=e.clientX-n.left,s=e.clientY-n.top,i=A.saturationPointerPos.x=o(0,t,a),p=A.saturationPointerPos.y=o(0,r,s);g.style.left=i-5+"px",g.style.top=p-5+"px",readCurrentColorFromRamps(),renderInputs()}function setFromHueElement(e){const{left:t,width:r}=getScreenBounds(b),a=e?getTouchPosition(e).clientX:t+r*n.constrainHue(c.h)/360,s=o(0,1,(a-t)/r),i=A.hueKnobPos=r*s;y.style.left=i-Math.round(y.offsetWidth/2)+"px",h.style.backgroundColor=hueDistanceToColorString(s),c.h=e?Math.round(360*s):c.h,renderInputs()}function setFromOpacityElement(e){const{left:t,width:r}=getScreenBounds(d),n=o(0,1,(getTouchPosition(e).clientX-t)/r),a=r*n;m.style.left=a-Math.ceil(m.offsetWidth/2)+"px",c.a=Math.round(100*n)/100,renderInputs()}function setFromFormatElement({shiftKey:e}){O=!0,c.a=isNaN(c.a)?1:c.a;const t=Object.keys(F),o=e?-1:1,r=t.length;H.colorString===H.prevColorString&&Object.assign(c,l),switchInputGroup(t[(t.indexOf(i)+o+r)%r]),renderInputs()}function setFromHexLettercaseElement(){const e=Boolean(S.hexUppercase);E[e].dataset.active="",delete E[!e].dataset.active;const t=w.value;w.value=e?t.toUpperCase():t.toLowerCase(),setFromInputs()}function setFromInputs(e){e&&(O=!0),Object.values(H[i]).every(validateInput)&&setFromColor(H.color)}function setFromKeyboard(e){const{key:t,ctrlKey:o,altKey:r,shiftKey:n,metaKey:a}=e;switch(t){case"Tab":case"PageUp":case"PageDown":if(!o&&!r&&!a){const o=document.activeElement,r=Object.values(H[i]),a=r[r.length-1];if("Tab"===t&&n&&o===r[0])maybeFocus(a);else if("Tab"!==t||n||o!==a){if("Tab"===t||n)return;setFromFormatElement({shift:"PageUp"===t||n})}else maybeFocus(r[0]);e.preventDefault()}return;case"ArrowUp":case"ArrowDown":return void(!e.metaKey&&"input"===document.activeElement.localName&&document.activeElement.checkValidity()&&setFromKeyboardIncrement(e))}}function setFromKeyboardIncrement(e){const t=document.activeElement,{key:r,ctrlKey:n,altKey:a,shiftKey:s}=e,p="ArrowUp"===r?1:-1;let c,l;if("hex"===i){c=t.value.trim();const e=c.length<=5,[r,i,u,h=""]=t.value.match(e?/[\da-f]/gi:/[\da-f]{2}/gi);let g,b;n||s||a?(g=e?15:255,b=[[n,r],[s,i],[a,u]]):(g=e?4095:16777215,b=[[!0,r+i+u]]),l="#"+b.map(([e,t])=>((t=o(0,g,parseInt(t,16)+p*(e?1:0)))+g+1).toString(16).slice(1)).join("")+h,l=S.hexUppercase?l.toUpperCase():l.toLowerCase()}else if(!a){c=parseFloat(t.value);const e="H"===t.title,r=t===H[i].a,a="rgb"===i;l=o(e?-360:0,e?360:r?1:a?255:100,c+(s&&!n?10:n&&!s?e||a?100:50:1)*(r?.01:1)*p),l=r?alphaToString(l):l}e.preventDefault(),O=!0,void 0!==l&&l!==c&&(t.value=l,setFromColor(H.color))}function validateInput(e){const t=e===H[i].a;let o=(t||e.value.trim())&&e.checkValidity();return t||o||"rgb"!==i?t&&!o&&(o=parseAs(e,parseFloat)):o=parseAs(e,parseInt),t&&o&&(o=T!==colorToString(H.color)),o}function setFromColor(e){e=(e="string"==typeof e?n.parse(e):e)||n.parse("#f00");const t=n.toHSV(e);Object.entries(t).every(([e,t])=>t===c[e]||Math.abs(t-c[e])<.001)||(c=t,renderKnobs(e),switchInputGroup(e.type),setFromHueElement())}function switchInputGroup(e){if(i!==e){if(i)delete F[i].dataset.active;else for(const e in F)delete F[e].dataset.active;F[e].dataset.active="",maybeFocus(Object.values(H[e])[0]),i=e}}function renderKnobs(e){const t=h.offsetWidth*c.s,r=h.offsetHeight*(1-c.v);g.style.left=t-5+"px",g.style.top=r-5+"px",A.saturationPointerPos={x:t,y:r};const n=b.offsetWidth*o(0,1,c.h/360);y.style.left=n-7.5+"px",A.hueKnobPos=n;const a=d.offsetWidth*(isNaN(c.a)?1:c.a);m.style.left=a-7.5+"px",h.style.backgroundColor=e}function renderInputs(){const e=n.fromHSV(c,"rgb");if("hex"===i)w.value=colorToString(e,"hex");else for(const[e,t]of Object.entries(n.fromHSV(c,i))){const o=H[i][e];o&&(o.value="a"===e?alphaToString()||1:Math.round(t))}x.style.backgroundColor=colorToString(e,"rgb"),f.style.background="linear-gradient(to right,"+colorToString(Object.assign(e,{a:0}),"rgb")+","+colorToString(Object.assign(e,{a:1}),"rgb")+")",colorpickerCallback();const t=H.colorString;H.prevColorString===t?Object.assign(c,l):(H.prevColorString=t,Object.assign(l,c))}function onPopupMoveStart(e){if(!e.button&&!hasModifiers(e)){captureMouse(e,"popup"),u.dataset.moving="";const[t,o]=(u.style.transform.match(/[-.\d]+/g)||[]).map(parseFloat);A.popupX=e.clientX-(t||0),A.popupY=e.clientY-(o||0),document.addEventListener("mouseup",onPopupMoveEnd)}}function onPopupMove({clientX:e,clientY:t}){u.style.transform=`translate(${e-A.popupX}px, ${t-A.popupY}px)`}function onPopupMoveEnd(e){e.button||(document.addEventListener("mouseup",onPopupMoveEnd),delete u.dataset.moving)}function onPopupResizeStart(e){e.target!==u||e.button||hasModifiers(e)||(document.addEventListener("mouseup",onPopupResizeEnd),u.dataset.resizing="")}function onPopupResizeEnd(e){e.button||(delete u.dataset.resizing,document.removeEventListener("mouseup",onPopupResizeEnd),p!==u.style.height&&(p=u.style.height,D.options.maxHeight=parseFloat(p),fitPaletteHeight()))}function onHexLettercaseClicked(){S.hexUppercase=!S.hexUppercase,setFromHexLettercaseElement()}function onSaturationMouseDown(e){captureMouse(e,"saturation")&&setFromSaturationElement(e)}function onSaturationMouseUp(e){releaseMouse(e,"saturation")}function onHueKnobMouseDown(e){captureMouse(e,"hue")}function onOpacityKnobMouseDown(e){captureMouse(e,"opacity")}function onHueMouseDown(e){captureMouse(e,"hue")&&setFromHueElement(e)}function onOpacityMouseDown(e){captureMouse(e,"opacity")&&setFromOpacityElement(e)}function onPaletteClicked(e){e.target!==e.currentTarget&&e.target.__color&&(!e.button&&setColor(e.target.__color)?(O=!0,colorpickerCallback()):e.button&&S.paletteCallback&&(e.preventDefault(),S.paletteCallback(e.target)))}function onMouseUp(e){releaseMouse(e,["saturation","hue","opacity","popup"]),onMouseDown.outsideClick&&(N||hide())}function onMouseDown(e){onMouseDown.outsideClick=!e.button&&!e.target.closest(".colorpicker-popup"),onMouseDown.outsideClick&&(N=null,captureMouse(e))}function onMouseMove(e){e.button||(A.saturation&&setFromSaturationElement(e),A.hue&&setFromHueElement(e),A.opacity&&setFromOpacityElement(e),A.popup&&onPopupMove(e))}function onKeyDown(e){if(!hasModifiers(e))switch(e.key){case"Enter":case"Escape":e.preventDefault(),e.stopPropagation(),hide()}}function onCloseRequest(e){e.detail!==D?hide():!N&&t&&(N=t.display.input)}function colorpickerCallback(e=currentColorToString()){const t="function"==typeof S.callback;e||!t?O&&Object.values(H[i]).every(e=>e.checkValidity())&&(T=e.replace(/\b0\./g,"."),t&&S.callback(T)):S.callback("")}function captureMouse({button:e},t){if(0===e&&(document.addEventListener("mouseup",onMouseUp),document.addEventListener("mousemove",onMouseMove),t)){for(const e of toArray(t))A[e]=!0;return O=!0,!0}}function hasModifiers(e){return e.shiftKey||e.ctrlKey||e.altKey||e.metaKey}function releaseMouse(e,t){if((!e||0===e.button)&&(document.removeEventListener("mouseup",onMouseUp),document.removeEventListener("mousemove",onMouseMove),t)){for(const e of toArray(t))A[e]=!1;return O=!0,!0}}function getTouchPosition(e){return e.touches&&e.touches[0]||e}function colorToString(e,t=i){return n.format(e,t,S)}function alphaToString(e=c.a){return n.formatAlpha(e)}function currentColorToString(e=i,t=c.a){const o=n.fromHSV(c,e);return o.a=isNaN(t)||1===t?void 0:t,colorToString(o,e)}function hueDistanceToColorString(e){let t;for(const a of s){if(t&&a.start>=e)return o=t,r=a,n=(e-t.start)/(a.start-t.start),colorToString({r:o.r+(r.r-o.r)*n,g:o.g+(r.g-o.g)*n,b:o.b+(r.b-o.b)*n,a:1},"hex");t=a}var o,r,n;return s[0].hex}function reposition(){const{offsetWidth:e,offsetHeight:t}=u,{top:r,left:n,right:a,bottom:s}=S,i=innerWidth-e,p=innerHeight-t,c=u.style;isNaN(n)?isNaN(a)||(c.right=o(0,Math.max(0,a<=i?i:a-e),a)+"px"):c.left=o(0,Math.max(0,n<=i?i:n-e),n)+"px",isNaN(r)?isNaN(s)||(c.bottom=o(0,Math.max(0,s<=p?p:s-t-20),s)+"px"):c.top=o(0,Math.max(0,r<=p?p:r-t-20),r)+"px",c.transform=""}function renderPalette(){for(;k.firstChild;)k.firstChild.remove();k.append(...S.palette),S.palette.length?(u.dataset.resizable="",u.addEventListener("mousedown",onPopupResizeStart),fitPaletteHeight()):(delete u.dataset.resizable,u.removeEventListener("mousedown",onPopupResizeStart))}function fitPaletteHeight(){const e=220+k.scrollHeight+8;u.style.setProperty("--fit-height",Math.min(e,parseFloat(p))+"px")}function maybeFocus(e){P&&e.focus()}function focusNoScroll(t){if(t){const{scrollY:o,scrollX:r}=e;t.focus({preventScroll:!0}),t=null,e.scrollY===o&&e.scrollX===r||setTimeout(e.scrollTo,0,r,o)}}function getScreenBounds(e){const t=e.getBoundingClientRect(),{scrollTop:o,scrollLeft:r}=document.scrollingElement;return{top:t.top+o,left:t.left+r,width:t.width,height:t.height}}function guessTheme(){const e=S.guessBrightness||t&&((t.display.renderedView||[])[0]||{}).text||t&&t.display.lineDiv;return(0,a.default)(e,{bg:"backgroundColor"}).bgLuma<.5?"dark":"light"}function parseAs(e,t){const o=t(e.value);if(!isNaN(o)&&(!e.min||o>=parseFloat(e.min))&&(!e.max||o<=parseFloat(e.max)))return e.value=o,!0}function toArray(e){return e?Array.isArray(e)?e:[e]:[]}}}}])}