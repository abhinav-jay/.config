{const e=this,t=e;(self.webpackChunkStylus=self.webpackChunkStylus||[]).push([["popup"],{3751:(e,n,o)=>{o.d(n,{configure:()=>configure,maybeEdit:()=>maybeEdit,openEditor:()=>openEditor,openManager:()=>openManager,openURLandHide:()=>openURLandHide,toggleUrlLink:()=>toggleUrlLink});var a=o(6001),s=o(9030),i=o(6308),l=o(9204),r=o(4523),c=o(4188),d=o(9499);const p=(0,a.$)("#menu"),u=[];function configure(e,t){this.target?openURLandHide.call(this,e):d.pause(async()=>(0,s.configDialog)(await l.API.styles.get(t.styleId)))}function maybeEdit(e){if((0!==e.button||!e.ctrlKey&&!e.metaKey)&&1!==e.button&&2!==e.button)return;const t=e.target;(t.matches(".entry, .style-edit-link")||t.closest(".style-name"))&&(this.onmouseup=()=>(0,a.$)(".style-edit-link",this).click(),this.oncontextmenu=e=>e.preventDefault(),e.preventDefault())}async function openEditor(e,n){e.preventDefault(),await l.API.openEditor(this.search||{id:n.styleId}),t.close()}async function openManager(e){e.preventDefault();const n=c.tabURL&&(e.shiftKey||2===e.button||"site"===e.detail);await l.API.openManage(n?{search:c.tabURL,searchMode:"url"}:{}),t.close()}async function openURLandHide(e){e.preventDefault(),await l.API.openURL({url:this.href||this.dataset.href,index:(await(0,r.getActiveTab)()).index+1}),t.close()}function toggleUrlLink({type:e}){this.parentElement.classList.toggle("url()","mouseenter"===e||"focus"===e)}const m={"#menu [data-cmd]"(){if("delete"===this.dataset.cmd){if(p.classList.toggle("delete"))return;l.API.styles.remove(p.styleId)}menuHide()},".copy"(e){e.preventDefault();const t=document.activeElement,n=(0,a.$)(".copy-message");navigator.clipboard.writeText(t.textContent),t.classList.add("copied"),n.classList.add("show-message"),setTimeout(()=>{t.classList.remove("copied"),n.classList.remove("show-message")},1e3)}},g={async input(e,t){e.stopPropagation(),await l.API.styles.toggle(t.styleId,this.checked),(0,c.resortEntries)()},".configure":configure,".menu-button"(e,n){u.length||menuInit();const o=n.styleMeta.exclusions||[];for(const e of u)e.el.title=e.rule,e.el.classList.toggle("enabled",e.input.checked=o.includes(e.rule));p.classList.remove("delete"),p.styleId=n.styleId,p.hidden=!1,t.on("keydown",menuOnKey),(0,a.$)("header",p).textContent=(0,a.$)(".style-name",n).textContent,(0,s.moveFocus)(p,0)},".style-edit-link":openEditor,".regexp-problem-indicator"(e,t){const n=i.template.regexpProblemExplanation.cloneNode(!0);(0,a.$remove)("#"+n.id),t.appendChild(n)},"#regexp-explanation a":openURLandHide,"#regexp-explanation button"(){(0,a.$)("#regexp-explanation").remove()}};function menuInit(){const e=new URL(c.tabURL);for(const t of(0,a.$$)("[data-exclude]")){const n=(0,a.$)("input",t),o=e.origin+("domain"===t.dataset.exclude?"/*":e.pathname.replace(/\*/g,"\\*"));u.push({el:t,input:n,rule:o}),n.onchange=()=>{t.classList.toggle("enabled",n.checked),l.API.styles.toggleOverride(p.styleId,o,!1,n.checked)}}}function menuHide(){p.hidden=!0,t.off("keydown",menuOnKey)}function menuOnKey(e){switch((0,s.getEventKeyName)(e)){case"Tab":case"Shift-Tab":e.preventDefault(),(0,s.moveFocus)(p,e.shiftKey?-1:1);break;case"Escape":e.preventDefault(),menuHide()}}document.on("click",e=>{const{target:t}=e,n=t.closest(".entry");for(let o=n?g:m;;o=m){const a=o["."+t.className]||o[t.localName];if(a)return a.call(t,e,n);for(const a in o)for(let s=t;s&&s!==n;s=s.parentElement)if(s.matches(a))return void o[a].call(s,e,n);if(o===m)break}})},9499:(e,n,o)=>{o.d(n,{pause:()=>pause});var a=o(6001),s=o(6308),i=o(9204);(0,s.tBody)();const l=document.getElementsByClassName("entry"),r=(0,a.$)("#hotkey-info"),{title:c}=r;let d,p=!0,u=getTogglables();async function pause(e,...t){setState(!1),await e(...t),setState(!0)}function setState(e=!d){!e!=!d&&(t[e?"on":"off"]("keydown",onKeyDown,!0),d=e)}function onKeyDown(e){if(e.ctrlKey||e.altKey||e.metaKey||!d||/^(text|search)$/.test(document.activeElement?.type))return;let t,{key:n,code:o,shiftKey:s}=e;if("Escape"===n&&!s&&r.dataset.active)return e.preventDefault(),void hideInfo();n>="0"&&n<="9"?t=l[(Number(n)||10)-1]:o>="Digit0"&&o<="Digit9"?t=l[(Number(o.slice(-1))||10)-1]:"`"===n||"*"===n||"Backquote"===o||"NumpadMultiply"===o?(u=u.length?u:getTogglables(),p=countEnabledTogglables()>u.length/2,toggleState(u,null,!p),p=!p):"-"===n||"NumpadSubtract"===o?toggleState(l,"enabled",!1):"+"===n||"NumpadAdd"===o?toggleState(l,"disabled",!0):1===n.length&&(s=!1,n=n.toLocaleLowerCase(),t=[...l].find(e=>e.innerText.toLocaleLowerCase().startsWith(n))),t&&(0,a.$)(s?".style-edit-link":"input",t).click()}function getTogglables(){return[...(0,a.$)(".entry.enabled")?(0,a.$$)(".entry.enabled"):l].map(e=>e.id)}function countEnabledTogglables(){let e=0;for(const t of u)e+=(0,a.$)(`#${t}`).classList.contains("enabled");return e}function toggleState(e,t,n){const o=[];let s=Promise.resolve();for(let l of e)l="string"==typeof l?(0,a.$)("#"+l):l,(!t&&(0,a.$)("input",l).checked!==n||l.classList.contains(t))&&(o.push(l.id),s=s.then(()=>i.API.styles.toggle(l.styleId,n)).then(()=>{l.classList.toggle("enabled",n),l.classList.toggle("disabled",!n),(0,a.$)("input",l).checked=n}));return o.length&&s.then(i.API.refreshAllTabs),o}function hideInfo(){delete r.dataset.active,document.body.style.height="",r.title=c}!function(){function open(){r.title="",r.style="",r.dataset.active=!0,r.firstElementChild||buildElement();const e=3+r.firstElementChild.scrollHeight+r.lastElementChild.scrollHeight;e>document.body.clientHeight&&(document.body.style.height=e+"px")}function buildElement(){const keysToElements=e=>e.split(/(<.*?>)/).map(e=>e.startsWith("<")?(0,a.$create)("mark",e.slice(1,-1)):e);var e;[(e=(0,s.t)("popupHotkeysInfo"),e.trim().split("\n").map((e,t,n)=>t<n.length-1?(0,a.$create)("p",keysToElements(e)):(0,a.$createLink)("https://github.com/openstyles/stylus/wiki/Popup",e))),(0,a.$create)("button",(0,s.t)("confirmOK"))].forEach(e=>{r.appendChild((0,a.$create)("div",e))})}r.onclick=({target:e})=>{"button"===e.localName?hideInfo():r.dataset.active||open()}}(),setState(!0)},4188:(n,o,a)=>{a.d(o,{$entry:()=>$entry,resortEntries:()=>resortEntries,styleFinder:()=>h,tabURL:()=>f}),a(4404);var s=a(6001),i=a(9030),l=a(6308),r=a(9204),c=a(2691),d=a(4435),p=a(1679),u=a(9521),m=a(4523),g=a(3751);a(9499);const h={};let f,b;const y=(0,s.$)("#installed"),$='.match:not([data-frame-id="0"]):not(.dupe)',k="style-",w=`<${m.MF.name}>`,E=new IntersectionObserver(function(e){for(const{target:t,boundingClientRect:n}of e){const e=t.$entry.styleMeta;t.title=e.sloppy?(0,l.t)("styleNotAppliedRegexpProblemTooltip"):e.excludedScheme?(0,l.t)(`styleNotAppliedScheme${(0,u.capitalize)(e.preferScheme)}`):t.scrollWidth>n.width+1?t.textContent:""}}),$entry=e=>(0,s.$)(`#${k}${e.id||e}`);function onWindowResize(){"complete"!==document.readyState?requestAnimationFrame(onWindowResize):document.body.clientHeight>innerHeight&&(removeEventListener("resize",onWindowResize),document.body.style.maxHeight=innerHeight+"px")}async function initPopup(e,n,o,p){const b="popupWidth";c.subscribe([b,"popupWidthMax"],(e,t)=>{document.body.style[(e===b?"min":"max")+"-width"]=d.MOBILE?"none":(0,u.clamp)(t,200,800)+"px"},!0),(0,i.setupLivePrefs)();const y=(0,s.$)("#find-styles-btn");y.on("click",async()=>{y.disabled=!0,h.on||await a.e("popup_search_js").then(a.bind(a,6670)),h.inline()}),y.on("split-btn",async e=>{h.on||await a.e("popup_search_js").then(a.bind(a,6670)),h.inSite(e)}),t.on("keydown",e=>{"Ctrl-F"===(0,i.getEventKeyName)(e)&&(e.preventDefault(),y.click())}),Object.assign((0,s.$)("#popup-manage-button"),{onclick:g.openManager,oncontextmenu:g.openManager}).on("split-btn",g.openManager),(0,s.$)("#options-btn").onclick=()=>{r.API.openManage({options:!0}),t.close()};for(const e of(0,s.$$)("link[media=print]"))e.removeAttribute("media");if(f=e[0].url,e.forEach(createWriterElement),(0,s.$)(".match .match:not(.dupe),"+$)&&(0,s.$)("#write-style").append(Object.assign(l.template.writeForFrames,{onclick(){this.remove(),(0,s.$)("#write-style").classList.add("expanded")}})),n)return;const k=d.FIREFOX?f.startsWith("https://addons.mozilla.org/"):d.OPERA?f.startsWith("https://addons.opera.com/"):f.startsWith("https://chrome.google.com/webstore/")||f.startsWith("https://chromewebstore.google.com/");if(blockPopup(),d.CHROME&&k||!p)return;for(let e=performance.now()+1e3;performance.now()<e;){if(await r.API.pingTab(o.id))return void blockPopup(!1);if("complete"===o.status&&(d.CHROME||"about:blank"!==o.url))break;await(0,u.sleep)(),o=await(0,m.getActiveTab)()}const w=l.template.unreachableInfo;if(d.CHROME)w.appendChild((0,s.$create)("p",(0,l.t)("unreachableFileHint")));else{(0,s.$)("label",w).textContent=(0,l.t)("unreachableAMO");const e=[!k&&(0,l.t)("unreachableCSP"),k&&(0,l.t)(d.FIREFOX>=59?"unreachableAMOHint":"unreachableMozSiteHintOldFF"),d.FIREFOX>=60&&(0,l.t)("unreachableMozSiteHint")].filter(Boolean).join("\n"),renderToken=e=>"<"===e[0]?(0,s.$create)("a.copy",{textContent:e.slice(1,-1),tabIndex:0,title:(0,l.t)("copy")}):e,renderLine=e=>(0,s.$create)("p",e.split(/(<.*?>)/).map(renderToken)),t=(0,s.$create)("fragment",e.split("\n").map(renderLine));w.appendChild(t)}f.length-f.lastIndexOf(".")<=5&&w.appendChild((0,s.$create)("p",(0,l.t)("InaccessibleFileHint"))),document.body.classList.add("unreachable");const E=(0,s.$)(".blocked-info");E?E.replaceWith(w):document.body.prepend(w)}function createWriterElement(e,t){const{url:n,frameId:o,parentFrameId:a,isDupe:i}=e,l=n.startsWith("about:"),r=[];let c;l?c=(0,s.$create)("span",n):(c=(n.startsWith(p.ownRoot)?makeExtCrumbs:makeWebCrumbs)(r,n),c.onmouseenter=c.onmouseleave=c.onfocus=c.onblur=g.toggleUrlLink,t||Object.assign((0,s.$)("#write-style-for"),{onclick:c.click.bind(c),title:c.title})),r.push(c);const d=(0,s.$)("#write-style"),u=(0,s.$)(`[data-frame-id="${a}"]`,d)||d,m=(0,s.$create)(`.match${i?".dupe":""}${l?".about-blank":""}`,{"data-frame-id":o},(0,s.$create)(".breadcrumbs",r));u.appendChild(m),u.dataset.children=(Number(u.dataset.children)||0)+1}function makeExtCrumbs(e,t){const n="regexp",o="^\\w+-extension://",a=t.slice(p.ownRoot.length,t.indexOf(".html"));return e.push(makeCrumb(n,o+".+",w,w,!0)),makeCrumb(n,`${o}[^/]+/${(0,u.stringAsRegExpStr)(a)}.*`,w,a+".*")}function makeWebCrumbs(e,t){const n=new URL(t),o=n.hostname,a=o||t,s=o&&(n.port?":"+n.port:"")+n.pathname+n.search+n.hash;for(let t,n,o=0;(t=a.slice(o))&&((n=t.split("."))[1]||!o);)n=n[2]?n[0]:t,e.push(makeCrumb("domain",t,"",n,!0)),o=a.indexOf(".",o+1)+1||a.length;return makeCrumb("url-prefix",t,"",(0,u.clipString)(s)||(0,l.t)("writeStyleForURL"))}function makeCrumb(e,t,n,o,a){const i={[e]:t};return n&&(i.name=n),(0,s.$create)("a.write-style-link",{href:"edit.html?"+new URLSearchParams(i),onclick:g.openEditor,title:`${e}("${t}")`,attributes:a&&{subdomain:""}},o)}function sortStyles(e){const t=c.get("popup.enabledFirst");return e.sort(({styleMeta:e},{styleMeta:n})=>Boolean(e.frameUrl)-Boolean(n.frameUrl)||t&&Boolean(n.enabled)-Boolean(e.enabled)||(e.customName||e.name).localeCompare(n.customName||n.name))}function showStyles(e){const t=new Map;for(let n=0;n<e.length;n++){if(b&&!n)continue;const o=e[n];for(let e of o.styles||[]){const a=e.style.id;t.has(a)||(e=Object.assign(e.style,e),e.frameUrl=n?o.url:"",t.set(a,createStyleElement(e)))}}resortEntries([...t.values()])}function resortEntries(e){(e||c.get("popup.autoResort"))&&y.append(...sortStyles(e||[...y.children]))}function createStyleElement(e,t){t?e=Object.assign(t.styleMeta,e):(t=l.template.style.cloneNode(!0),Object.assign(t,{id:k+e.id,styleId:e.id,styleMeta:e,onmousedown:g.maybeEdit}));const{enabled:n,frameUrl:o,usercssData:a}=e,i=(0,s.$)(".style-name",t),r=(0,s.$)(".configure",t),c=a?"":e.url,d=t.classList;if(d.toggle("empty",e.empty),d.toggle("disabled",!n),d.toggle("enabled",n),d.toggle("force-applied",e.included),d.toggle("not-applied",e.excluded||e.sloppy||e.excludedScheme),d.toggle("regexp-partial",e.sloppy),d.toggle("frame",!!o),(0,s.$)("input",t).checked=n,i.$entry=t,i.lastChild.textContent=e.customName||e.name,r.hidden=a?(0,u.isEmptyObj)(a.vars):!e.url||!`${e.updateUrl}`.includes("?"),!r.hidden&&r.href!==c){const e=l.template[a?"config":"configExternal"].cloneNode(!0);c?e.href=c:e.removeAttribute("href"),r.replaceWith(e)}if(o){const e="span.frame-url",n=(0,s.$)(e,t)||i.insertBefore((0,s.$create)(e),i.lastChild);n.title=o,n.onmousedown=g.maybeEdit}return E.observe(i),t}async function handleUpdate({style:e,reason:t}){const n=$entry(e);if("toggle"!==t||!n){if([e]=await r.API.styles.getByUrl(f,e.id),!e)return;e=Object.assign(e.style,e)}const o=createStyleElement(e,n);o.isConnected||y.append(o),resortEntries()}function blockPopup(e=!0){b=e,s.$.rootCL.toggle("blocked",b),(0,s.$)("#write-wrapper").classList.toggle("hidden",!(0,s.$)($))}(async()=>{const e=c.clientData.popup;initPopup(...e),showStyles(...e),d.MOBILE||t.on("resize",onWindowResize)})(),(0,r.onExtension)(function(e){if(!f)return;let t;switch(e.method){case"styleAdded":case"styleUpdated":if("editPreview"===e.reason||"editPreviewEnd"===e.reason)return;t=handleUpdate(e);break;case"styleDeleted":(0,s.$remove)($entry(e.style.id))}h.on?.(e,t)}),c.subscribe("popup.stylesFirst",(e,t)=>{s.$.rootCL.toggle("styles-first",t),s.$.rootCL.toggle("styles-last",!t)},!0),c.subscribe("disableAll",(t,n)=>{e[t].title=(0,l.t)("masterSwitch")+":\n"+(0,l.t)(n?"disableAllStylesOff":"genericEnabledLabel")},!0)}},e=>{e.O(0,["common-ui","css_global-dark_css-css_global_css-css_spinner_css"],()=>e(e.s=4188)),e.O()}])}